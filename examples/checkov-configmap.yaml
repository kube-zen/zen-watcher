# Example: Checkov via ConfigMap (using informer ingester)
# ConfigMaps are handled via ingester: informer with GVR
apiVersion: zen.kube-zen.io/v1
kind: Ingester
metadata:
  name: checkov-ingester
  namespace: default
spec:
  source: checkov
  ingester: informer
  informer:
    gvr:
      group: ""
      version: "v1"
      resource: "configmaps"
    namespace: ""
    labelSelector: "app=checkov"
    resyncPeriod: "30m"
  normalization:
    domain: security
    type: iac_vulnerability
    priority:
      CRITICAL: 0.9
      HIGH: 0.7
      MEDIUM: 0.5
      LOW: 0.3
    fieldMapping:
      - from: "$.extracted.check_id"
        to: "check_id"
      - from: "$.extracted.severity"
        to: "severity"
  filter:
    minPriority: 0.3
  dedup:
    enabled: true
    window: "2h"
    strategy: fingerprint
  processing:
    order: auto
  destinations:
    - type: crd
      gvr:
        group: ""
        version: "v1"
        resource: "configmaps"
      mapping:
        domain: security
        type: iac_vulnerability
