apiVersion: zen.kube-zen.io/v1alpha1
kind: ObservationSourceConfig
metadata:
  name: kube-bench-config
spec:
  source: kube-bench
  ingester: cm
  configmap:
    namespace: ""
    labelSelector: app=kube-bench
    pollInterval: "15m"
    jsonPath: ""
  normalization:
    domain: compliance
    type: cis_benchmark_finding
    priority:
      FAIL: 0.8
      WARN: 0.5
      PASS: 0.1
    fieldMapping:
      - from: extracted.test_id
        to: test_id
      - from: extracted.status
        to: status
  filter:
    minPriority: 0.4
  dedup:
    window: "1h"
    strategy: fingerprint
  thresholds:
    observationsPerMinute:
      warning: 20
      critical: 50

